# Local development overrides â€” copy this to docker-compose.override.yml before running locally.
# This file is gitignored so it is never present on the production server.
#
# What this does:
#   - Exposes Icecast port 8000 directly (for debugging; not needed for the stream itself)
#   - Uses the HTTP-only nginx config (no TLS/certbot needed locally)
#   - Sets SERVER_HOSTNAME=localhost
#   - Disables the certbot renewal container

services:
  icecast:
    ports:
      - "8000:8000"

  liquidsoap:
    environment:
      - ICECAST_SOURCE_PASSWORD=${ICECAST_SOURCE_PASSWORD}
      - SERVER_HOSTNAME=localhost

  nginx:
    volumes:
      - ./nginx/local.conf.template:/etc/nginx/templates/default.conf.template:ro
      - ./nginx/.htpasswd:/etc/nginx/.htpasswd:ro
      - ./frontend:/usr/share/nginx/html:ro
    environment:
      - SERVER_HOSTNAME=localhost
    logging:
      driver: json-file

  certbot:
    entrypoint: ["sh", "-c", "echo 'certbot disabled locally' && sleep infinity"]
